{"version":3,"sources":["components/Navbar.js","components/Sidebar.js","scripts/imageRotation.js","components/ImagePanel.js","components/Content.js","App.js","index.js"],"names":["Navbar","className","Sidebar","props","useState","defaultFile","name","fileName","setFileName","width","setWidth","height","setHeight","angle","setAngle","canvasRef","useRef","canvas","setCanvas","initialized","setInitialized","useEffect","current","load","source","img","Image","src","onload","getContext","drawImage","imageData","getImageData","loadImageData","process","id","type","value","onClick","document","getElementById","click","accept","onChange","raw","target","files","length","file","match","reader","FileReader","readAsDataURL","evt","readyState","DONE","result","hidden","ref","style","display","maxLength","size","e","tryRotate","htmlFor","checked","outlined","setOutlined","rotate","image","Math","PI","inverted","pixelArr","invertedArr","Uint8ClampedArray","i","inverse","data","ImageData","util","Canvas","BackupData","Init","Clear","ReDraw","putImageData","Rotate","setRenderTime","Recall","ctx","start","performance","now","clearRect","ImagePanel","renderTime","loadedImageData","rotated","rotateAngle","setRotated","border","defaultFileInfo","Content","setLoadedImageData","setRotateAngle","App","ReactDOM","render","StrictMode"],"mappings":"6SAWeA,MARf,WACE,OACE,qBAAKC,UAAU,SAAf,SACE,kD,aCoJSC,MAvJf,SAAiBC,GAAQ,IAAD,EACUC,mBAASD,EAAME,YAAYC,MADrC,mBACfC,EADe,KACLC,EADK,OAEIJ,mBAASD,EAAME,YAAYI,OAF/B,mBAEfA,EAFe,KAERC,EAFQ,OAGMN,mBAASD,EAAME,YAAYM,QAHjC,mBAGfA,EAHe,KAGPC,EAHO,OAIIR,mBAAS,GAJb,mBAIfS,EAJe,KAIRC,EAJQ,KAMhBC,EAAYC,iBAAO,MANH,EAOMZ,mBAAS,MAPf,mBAOfa,EAPe,KAOPC,EAPO,OAQgBd,oBAAS,GARzB,mBAQfe,EARe,KAQFC,EARE,KAUtBC,qBAAU,WAERH,EAAUH,EAAUO,WACnB,IAEH,IA0BMC,EAAO,SAACC,GACZ,GAAIA,EAAQ,CACV,IAAIC,EAAM,IAAIC,MACdD,EAAIE,IAAMH,EACVC,EAAIG,OAAS,WAEXX,EAAOR,MAAQgB,EAAIhB,MACnBQ,EAAON,OAASc,EAAId,OAGpBM,EAAOY,WAAW,MAAMC,UAAUL,EAAK,EAAG,GAC1C,IAAMM,EAAYd,EACfY,WAAW,MACXG,aAAa,EAAG,EAAGf,EAAOR,MAAOQ,EAAON,QAC3CR,EAAM8B,cAAcF,GAGpBrB,EAASe,EAAIhB,OACbG,EAAUa,EAAId,WAgBpB,OALKQ,GAAeF,IAClBM,EAAKW,8BACLd,GAAe,IAIf,sBAAKnB,UAAU,UAAf,UACE,sBAAKA,UAAU,oBAAf,UACE,uBACEkC,GAAG,oBACHlC,UAAU,yBACVmC,KAAK,SACLC,MAAM,eACNC,QApEkB,WAExBC,SAASC,eAAe,eAAeH,MAAQ,KAG/CE,SAASC,eAAe,eAAeC,WAiEnC,uBACEN,GAAG,cACHC,KAAK,OACLM,OAAO,UACPC,SAlEe,SAACC,GACtB,GAAIA,GAAmC,IAA5BA,EAAIC,OAAOC,MAAMC,OAAc,CACxC,IAAIC,EAAOJ,EAAIC,OAAOC,MAAM,GAC5B,GAAIE,EAAKZ,KAAKa,MAAM,WAAY,CAE9B,IAAIC,EAAS,IAAIC,WACjBD,EAAOE,cAAcJ,GACrBE,EAAOtB,OAAS,SAAUyB,GACpBA,EAAIR,OAAOS,aAAeH,WAAWI,OACvChC,EAAK8B,EAAIR,OAAOW,QAChBhD,EAAYwC,EAAK1C,WAyDnBmD,QAAM,IAER,wBAAQC,IAAK3C,EAAW4C,MAAO,CAAEC,QAAS,aAG5C,qBAAK3D,UAAU,oBAEf,sBAAKA,UAAU,uBAAf,UACE,gCACE,+BACE,yCAEF,+BAAOM,OAET,gCACE,+BACE,yCAEF,+BAAOE,OAET,gCACE,+BACE,0CAEF,+BAAOE,OAET,gCACE,+BACE,0CAEF,iCACE,uBACEwB,GAAG,aACHC,KAAK,OACLyB,UAAU,IACVC,KAAK,IACLnB,SAAU,SAACoB,GAAD,OAAOjD,EAASiD,EAAElB,OAAOR,UAErC,uBACED,KAAK,SACLnC,UAAU,yBACVoC,MAAM,QACNC,QAnEY,WACtBnC,EAAM6D,UAAUnD,YAsEZ,sBAAKZ,UAAU,eAAf,UAEE,uBAAOgE,QAAQ,kBAAf,sBACA,uBACE7B,KAAK,WACLD,GAAG,kBACH+B,QAAS/D,EAAMgE,SACfxB,SAAU,SAACoB,GAAD,OAAO5D,EAAMiE,YAAYL,EAAElB,OAAOqB,sB,MCpIxD,SAASG,EAAOC,EAAOzD,GAWJ0D,KAAKC,GAVtB,IAEIC,EAaN,SAAiBC,EAAU3B,GAGzB,IAFA,IAAM4B,EAAc,IAAIC,kBAAkB7B,GAEjC8B,EAAI,EAAGA,EAAI9B,EAAQ8B,GAAK,EAC/BF,EAAYE,EAAI,GAAK,IAAMH,EAASG,EAAI,GACxCF,EAAYE,EAAI,IAAM,IAAMH,EAASG,EAAI,GACzCF,EAAYE,EAAI,IAAM,IAAMH,EAASG,EAAI,GACzCF,EAAYE,EAAI,GAAK,IAEvB,OAAOF,EAtBQG,CAAQR,EAAMS,KAAMT,EAAMS,KAAKhC,QAE9C,OAAO,IAAIiC,UAAUP,EAAUH,EAAM7D,MAAO6D,EAAM3D,QCKpD,IAAMsE,EAAO,CACXC,OAAQ,KACRC,WAAY,KACZC,KAAM,SAACrE,GACLkE,EAAKC,OAASnE,EACdkE,EAAKI,SAEPC,OAAQ,SAACvD,IAEPkD,EAAKE,WAAapD,EAClBkD,EAAKI,QACDtD,KACFkD,EAAKC,OAAOzE,MAAQsB,EAAUtB,MAC9BwE,EAAKC,OAAOvE,OAASoB,EAAUpB,OACnBsE,EAAKC,OAAOrD,WAAW,MAC/B0D,aAAaxD,EAAW,EAAG,KAInCyD,OAAQ,SAAC3E,EAAO4E,GAIdR,EAAKS,SAEL,IAAMC,EAAMV,EAAKC,OAAOrD,WAAW,MAC/BkD,EAAOY,EAAI3D,aAAa,EAAG,EAAGiD,EAAKC,OAAOzE,MAAOwE,EAAKC,OAAOvE,QAC3DiF,EAAQC,YAAYC,MACtBtC,EAASa,EAAOU,EAAMlE,GAG1B8E,EAAIJ,aAAa/B,EAAQ,EAAG,GAE5BiC,EADYI,YAAYC,MACJF,IAEtBP,MAAO,WAELJ,EAAKC,OAAOrD,WAAW,MAAMkE,UAC3B,EACA,EACAd,EAAKC,OAAOzE,MACZwE,EAAKC,OAAOvE,SAGhB+E,OAAQ,WAEFT,EAAKE,YACPF,EAAKK,OAAOL,EAAKE,cA8CRa,MAzCf,SAAoB7F,GAAQ,IAAD,EACOC,oBAAS,GADhB,mBAClB+D,EADkB,KACRC,EADQ,OAEWhE,mBAAS,GAFpB,mBAElB6F,EAFkB,KAENR,EAFM,KAInB1E,EAAYC,iBAAO,MAyBzB,OAvBAK,qBAAU,WAER4D,EAAKG,KAAKrE,EAAUO,WACnB,IAGHD,qBAAU,WACR+C,EAAYjE,EAAMgE,YACjB,CAAChE,EAAMgE,WAEV9C,qBAAU,WAER4D,EAAKK,OAAOnF,EAAM+F,mBACjB,CAAC/F,EAAM+F,kBAEV7E,qBAAU,WACHlB,EAAMgG,UACTlB,EAAKO,OAAOrF,EAAMiG,YAAaX,GAC/BtF,EAAMkG,YAAW,MAGlB,CAAClG,IAGF,sBAAKF,UAAU,iBAAf,UACE,wBACEkC,GAAG,WACHuB,IAAK3C,EACL4C,MAAO,CAAE2C,OAAQnC,EAAW,gBAAkB,UAEhD,sBAAKhC,GAAG,aAAR,0BAAmC8D,EAAnC,sBC3GAM,G,MAAkB,CAAEjG,KAAM,cAAeG,MAAO,IAAKE,OAAQ,MAuCpD6F,MArCf,WAAoB,IAAD,EACepG,oBAAS,GADxB,mBACV+D,EADU,KACAC,EADA,OAE6BhE,mBAAS,MAFtC,mBAEV8F,EAFU,KAEOO,EAFP,OAGqBrG,mBAAS,MAH9B,mBAGVgG,EAHU,KAGGM,EAHH,OAIatG,oBAAS,GAJtB,mBAIV+F,EAJU,KAIDE,EAJC,KAcjB,OACE,sBAAKpG,UAAU,UAAf,UAEE,cAAC,EAAD,CACEgC,cAAewE,EACfpG,YAAakG,EACbvC,UAbY,SAACnD,GACjB6F,EAAe7F,GAGfwF,GAAW,IAUPjC,YAAaA,EACbD,SAAUA,IAIZ,cAAC,EAAD,CACE+B,gBAAiBA,EACjB/B,SAAUA,EACViC,YAAaA,EACbD,QAASA,EACTE,WAAYA,QCzBLM,MATf,WACE,OACE,sBAAK1G,UAAU,MAAf,UACE,cAAC,EAAD,IACA,cAAC,EAAD,QCHN2G,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFvE,SAASC,eAAe,W","file":"static/js/main.3b4e6595.chunk.js","sourcesContent":["import React from \"react\";\r\nimport \"../styles/Navbar.css\";\r\n\r\nfunction Navbar() {\r\n  return (\r\n    <div className=\"navbar\">\r\n      <h3>Image Rotator</h3>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Navbar;\r\n","import React, { useState, useRef, useEffect } from \"react\";\r\nimport \"../styles/Sidebar.css\";\r\n\r\nfunction Sidebar(props) {\r\n  const [fileName, setFileName] = useState(props.defaultFile.name);\r\n  const [width, setWidth] = useState(props.defaultFile.width);\r\n  const [height, setHeight] = useState(props.defaultFile.height);\r\n  const [angle, setAngle] = useState(0);\r\n  // we have to use a ref, which is a reference to the actual canvas DOM element.\r\n  const canvasRef = useRef(null);\r\n  const [canvas, setCanvas] = useState(null);\r\n  const [initialized, setInitialized] = useState(false);\r\n\r\n  useEffect(() => {\r\n    // Initialize Canvas State, this will be called only once\r\n    setCanvas(canvasRef.current);\r\n  }, []);\r\n\r\n  const triggerFileUpload = () => {\r\n    // reset previous file value to enable loading same file again and again\r\n    document.getElementById(\"imageLoader\").value = null;\r\n\r\n    // trigger input file to open file browser\r\n    document.getElementById(\"imageLoader\").click();\r\n  };\r\n\r\n  const tryToLoadImage = (raw) => {\r\n    if (raw && raw.target.files.length !== 0) {\r\n      let file = raw.target.files[0];\r\n      if (file.type.match(\"image.*\")) {\r\n        // then we have a image, load it!\r\n        let reader = new FileReader();\r\n        reader.readAsDataURL(file);\r\n        reader.onload = function (evt) {\r\n          if (evt.target.readyState === FileReader.DONE) {\r\n            load(evt.target.result);\r\n            setFileName(file.name);\r\n          }\r\n        };\r\n      }\r\n    }\r\n  };\r\n\r\n  // to load given file source as image\r\n  const load = (source) => {\r\n    if (source) {\r\n      let img = new Image();\r\n      img.src = source;\r\n      img.onload = function () {\r\n        // rearrange canvas size according to loaded image\r\n        canvas.width = img.width;\r\n        canvas.height = img.height;\r\n\r\n        // send loaded image's data file to upper component\r\n        canvas.getContext(\"2d\").drawImage(img, 0, 0);\r\n        const imageData = canvas\r\n          .getContext(\"2d\")\r\n          .getImageData(0, 0, canvas.width, canvas.height);\r\n        props.loadImageData(imageData);\r\n\r\n        // set data for file information area\r\n        setWidth(img.width);\r\n        setHeight(img.height);\r\n      };\r\n    }\r\n    // Else: invalid source, do nothing\r\n  };\r\n\r\n  const btnApplyOnClick = () => {\r\n    props.tryRotate(angle);\r\n  };\r\n\r\n  // set default image on initialization\r\n  if (!initialized && canvas) {\r\n    load(process.env.PUBLIC_URL + \"/default.png\");\r\n    setInitialized(true);\r\n  }\r\n\r\n  return (\r\n    <div className=\"sidebar\">\r\n      <div className=\"sideBarSectionTop\">\r\n        <input\r\n          id=\"uploadImageButton\"\r\n          className=\"btn btn-blue btn-large\"\r\n          type=\"button\"\r\n          value=\"Upload Image\"\r\n          onClick={triggerFileUpload}\r\n        />\r\n        <input\r\n          id=\"imageLoader\"\r\n          type=\"file\"\r\n          accept=\"image/*\"\r\n          onChange={tryToLoadImage}\r\n          hidden\r\n        />\r\n        <canvas ref={canvasRef} style={{ display: \"none\" }}></canvas>\r\n      </div>\r\n\r\n      <div className=\"horizontalBreak\"></div>\r\n\r\n      <div className=\"sideBarSectionMiddle\">\r\n        <div>\r\n          <span>\r\n            <b>File: </b>\r\n          </span>\r\n          <span>{fileName}</span>\r\n        </div>\r\n        <div>\r\n          <span>\r\n            <b>Width:</b>\r\n          </span>\r\n          <span>{width}</span>\r\n        </div>\r\n        <div>\r\n          <span>\r\n            <b>Height:</b>\r\n          </span>\r\n          <span>{height}</span>\r\n        </div>\r\n        <div>\r\n          <span>\r\n            <b>Rotate:</b>\r\n          </span>\r\n          <span>\r\n            <input\r\n              id=\"inputAngle\"\r\n              type=\"text\"\r\n              maxLength=\"3\"\r\n              size=\"3\"\r\n              onChange={(e) => setAngle(e.target.value)}\r\n            />\r\n            <input\r\n              type=\"button\"\r\n              className=\"btn btn-blue btn-small\"\r\n              value=\"Apply\"\r\n              onClick={btnApplyOnClick}\r\n            />\r\n          </span>\r\n        </div>\r\n        <div className=\"hoverPointer\">\r\n          {/* htmlFor instead of for thanks to React! */}\r\n          <label htmlFor=\"outlineCheckbox\">Outlined</label>\r\n          <input\r\n            type=\"checkbox\"\r\n            id=\"outlineCheckbox\"\r\n            checked={props.outlined}\r\n            onChange={(e) => props.setOutlined(e.target.checked)}\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Sidebar;\r\n","// Pixel Manipulation for a given ImageData\r\n\r\n// pixel manipulation reference from MDN\r\n// https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Pixel_manipulation_with_canvas\r\n// https://github.com/mdn/dom-examples/blob/master/canvas/pixel-manipulation/color-manipulation.js\r\n\r\n// ImageData creation\r\n// give rotated image's width and height as second and third parameter, respectively.\r\n// https://developer.mozilla.org/en-US/docs/Web/API/ImageData/ImageData\r\n//  array: Uint8ClampedArray\r\n//  width\r\n//  height\r\n\r\n// Rotates given ImageData regarding given angle\r\nfunction rotate(image, angle) {\r\n  let radian = convertToRadian(angle);\r\n\r\n  let inverted = inverse(image.data, image.data.length);\r\n\r\n  return new ImageData(inverted, image.width, image.height);\r\n}\r\n\r\n// convert given degree to radian\r\nfunction convertToRadian(degree) {\r\n  // degree * PI / 180\r\n  return (degree * Math.PI) / 180;\r\n}\r\n\r\n// only for test purposes to make sure everything works as expected\r\n// inverse given pixel array\r\nfunction inverse(pixelArr, length) {\r\n  const invertedArr = new Uint8ClampedArray(length);\r\n  // Iterate through every pixel\r\n  for (let i = 0; i < length; i += 4) {\r\n    invertedArr[i + 0] = 255 - pixelArr[i + 0]; // R value\r\n    invertedArr[i + 1] += 255 - pixelArr[i + 1]; // G value\r\n    invertedArr[i + 2] += 255 - pixelArr[i + 2]; // B value\r\n    invertedArr[i + 3] = 255; // fully opaque:255 -- complete transparent:0\r\n  }\r\n  return invertedArr;\r\n}\r\n\r\nexport { rotate };\r\n","import React, { useEffect, useState, useRef } from \"react\";\r\nimport \"../styles/ImagePanel.css\";\r\nimport { rotate } from \"../scripts/imageRotation\";\r\n\r\n// ImagePanel is designed to work with ImageData Object as separated from other concerns\r\n\r\n// context.getImageData returns ImageData which is one-dimensional array\r\n// containing raw pixel data with RGBA format\r\n// ImageData\r\n//  .width\r\n//  .height\r\n//  .data : Uint8ClampedArray --> each pixel is represented by four one-byte values in RGBA format\r\n//                                data goes left to right then downward throughtout the array\r\n// https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Pixel_manipulation_with_canvas\r\n\r\n// to read ImageData\r\n//    var myImageData = ctx.getImageData(left, top, width, height);\r\n\r\n// to write ImageData\r\n//    ctx.putImageData(myImageData, dx, dy);\r\n\r\n// to loop\r\n//    (var i = 0; i < data.length; i += 4)\r\n\r\nconst util = {\r\n  Canvas: null,\r\n  BackupData: null,\r\n  Init: (canvasRef) => {\r\n    util.Canvas = canvasRef;\r\n    util.Clear();\r\n  },\r\n  ReDraw: (imageData) => {\r\n    // imageData is an ImageData Object with three members; width, height, data\r\n    util.BackupData = imageData;\r\n    util.Clear();\r\n    if (imageData) {\r\n      util.Canvas.width = imageData.width;\r\n      util.Canvas.height = imageData.height;\r\n      const ctx = util.Canvas.getContext(\"2d\");\r\n      ctx.putImageData(imageData, 0, 0);\r\n    }\r\n    // Else: defensive - not expected to execute in normal run\r\n  },\r\n  Rotate: (angle, setRenderTime) => {\r\n    // before rotation we need to keep our original image source to prevent\r\n    // repetitive rotation over already rotated image\r\n    // so we will recall our originaly loaded image on each request\r\n    util.Recall();\r\n\r\n    const ctx = util.Canvas.getContext(\"2d\");\r\n    let data = ctx.getImageData(0, 0, util.Canvas.width, util.Canvas.height);\r\n    const start = performance.now();\r\n    let result = rotate(data, angle);\r\n    // Draw image data to the canvas\r\n    // last two parameters are paddings (start point(x,y) of image), give them as 0\r\n    ctx.putImageData(result, 0, 0);\r\n    const end = performance.now();\r\n    setRenderTime(end - start);\r\n  },\r\n  Clear: () => {\r\n    // clear canvas\r\n    util.Canvas.getContext(\"2d\").clearRect(\r\n      0,\r\n      0,\r\n      util.Canvas.width,\r\n      util.Canvas.height\r\n    );\r\n  },\r\n  Recall: () => {\r\n    // reset/recall our originaly loaded file\r\n    if (util.BackupData) {\r\n      util.ReDraw(util.BackupData);\r\n    }\r\n  },\r\n};\r\n\r\nfunction ImagePanel(props) {\r\n  const [outlined, setOutlined] = useState(true);\r\n  const [renderTime, setRenderTime] = useState(0);\r\n  // we have to use a ref, which is a reference to the actual canvas DOM element.\r\n  const canvasRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    // Initialize Util.Canvas, this will be called only once\r\n    util.Init(canvasRef.current);\r\n  }, []);\r\n\r\n  // keep an eye on outlined property for border style of our canvas\r\n  useEffect(() => {\r\n    setOutlined(props.outlined);\r\n  }, [props.outlined]);\r\n\r\n  useEffect(() => {\r\n    // Re-draw our newly loaded image\r\n    util.ReDraw(props.loadedImageData);\r\n  }, [props.loadedImageData]);\r\n\r\n  useEffect(() => {\r\n    if (!props.rotated) {\r\n      util.Rotate(props.rotateAngle, setRenderTime);\r\n      props.setRotated(true);\r\n    }\r\n    // Else: angle received as invalid, do nothing\r\n  }, [props]);\r\n\r\n  return (\r\n    <div className=\"imageContainer\">\r\n      <canvas\r\n        id=\"myCanvas\"\r\n        ref={canvasRef}\r\n        style={{ border: outlined ? \"2px solid red\" : \"none\" }}\r\n      />\r\n      <div id=\"renderTime\">Render Time: {renderTime} miliseconds</div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ImagePanel;\r\n","import React, { useState } from \"react\";\r\nimport Sidebar from \"./Sidebar\";\r\nimport ImagePanel from \"./ImagePanel\";\r\nimport \"../styles/Content.css\";\r\n\r\nconst defaultFileInfo = { name: \"default.png\", width: 440, height: 250 };\r\n\r\nfunction Content() {\r\n  const [outlined, setOutlined] = useState(true);\r\n  const [loadedImageData, setLoadedImageData] = useState(null);\r\n  const [rotateAngle, setRotateAngle] = useState(null);\r\n  const [rotated, setRotated] = useState(true);\r\n\r\n  // callback for rotate angle setting\r\n  const tryRotate = (angle) => {\r\n    setRotateAngle(angle);\r\n    // reset rotated status so that image panel can handle rotation even if same angle is given\r\n    // so if we are not allowed to rotate over same angle then remove [rotated] state usage\r\n    setRotated(false);\r\n  };\r\n\r\n  return (\r\n    <div className=\"content\">\r\n      {/* this component will set loaded image */}\r\n      <Sidebar\r\n        loadImageData={setLoadedImageData}\r\n        defaultFile={defaultFileInfo}\r\n        tryRotate={tryRotate}\r\n        setOutlined={setOutlined}\r\n        outlined={outlined}\r\n      ></Sidebar>\r\n\r\n      {/* this component will use loaded image */}\r\n      <ImagePanel\r\n        loadedImageData={loadedImageData}\r\n        outlined={outlined}\r\n        rotateAngle={rotateAngle}\r\n        rotated={rotated}\r\n        setRotated={setRotated}\r\n      ></ImagePanel>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Content;\r\n","import \"./App.css\";\nimport Navbar from \"./components/Navbar\";\nimport Content from \"./components/Content\";\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <Navbar></Navbar>\n      <Content></Content>\n    </div>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}